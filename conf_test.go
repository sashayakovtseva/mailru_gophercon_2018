package main

import (
	"bufio"
	"bytes"
	// "io"
	"io/ioutil"
	"os"
	"testing"
)

var (
	networks = []string{}
	data     []byte
)

func init() {
	f, err := os.Open("./data.json")
	if err != nil {
		panic(err)
	}
	data, _ = ioutil.ReadAll(f)
	f.Close()

	f, err = os.Open("./search_networks.txt")
	if err != nil {
		panic(err)
	}
	in := bufio.NewScanner(f)
	for in.Scan() {
		networks = append(networks, in.Text())
	}
	f.Close()
}

type TestCase struct {
	In     string
	Result string
}

/*

CGO_ENABLED=0 go test -v -bench . -benchmem -benchtime 30s -cpu 4

	Выходной формат:
Total: X
[idx] Name <Email>
где:
X - сколько нашлось результатов
idx - порядковый номер результата в файле, начинается с 1
Name - имя из записи
Email - адрес ящику, у которого была проведена замена "@" -> " [at] "
*/

var cases = []TestCase{
	TestCase{ // 1/1
		In: `{"browsers":["Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36","Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.168 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36"],"company":"Skipfire","country":"Monaco","email":"JoseRomero@Thoughtmix.org","hits":["150.10.28.250","1.81.107.39","172.178.207.103","25.96.253.145","63.198.176.96","81.150.98.240","121.11.252.179","254.192.119.252","192.95.22.223","145.186.94.37","117.179.71.44","137.204.50.81","80.254.244.66","47.199.68.196","128.42.194.71","190.213.113.61","52.227.224.203","68.81.50.45","57.164.238.106","219.75.15.35","128.117.248.245","192.177.145.8","140.94.249.140","182.182.77.128","6.32.253.118","10.69.175.106","26.236.228.139","167.206.176.165","160.244.128.83","205.113.46.65","88.141.29.168","49.231.132.206","233.52.73.72","231.27.119.162","150.106.167.112","21.238.22.243","194.18.16.247","41.37.139.95","107.106.47.204","185.205.36.159","6.151.114.122","180.32.174.123","121.53.24.145","115.246.105.4","44.78.113.109","23.158.227.114","3.107.179.69","111.140.177.80","63.191.66.233","95.59.59.122","40.229.223.225","12.232.104.18","155.242.184.242","25.161.231.126","159.141.97.147","168.78.228.164","195.208.246.26","46.56.185.141","187.55.61.33","152.59.73.8","38.204.38.129","84.151.202.253","129.250.247.223","51.46.238.177","177.182.82.9","58.225.56.149","213.73.22.114","217.59.80.12","9.244.182.247","239.231.247.11","203.194.60.26","0.146.49.94","43.83.72.93","242.177.229.115","116.89.69.97","255.50.222.88","165.151.248.137","25.50.212.213","215.17.200.222","169.218.191.215","112.73.90.127","90.38.251.232","26.212.9.235","187.52.221.50","68.122.61.41","22.14.127.61","37.208.143.224","69.249.6.49","99.139.164.55","162.178.123.166","14.20.91.238","250.8.88.54","115.237.151.218","27.219.227.246","95.149.52.178","75.86.33.199","230.189.242.4","240.132.76.160","26.246.246.150","96.54.186.19"],"job":"Nurse","name":"Julie Williams","phone":"3-921-972-40-31"}
`,
		Result: `Total: 1
[1] Julie Williams <JoseRomero [at] Thoughtmix.org>
`,
	},
	TestCase{ // 2/3
		In: `{"browsers":["Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko","Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0","Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0","Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (Windows NT 6.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;  Trident/5.0)","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36"],"company":"Blogtag","country":"Macau","email":"saepe_voluptatem@Zoomdog.com","hits":["198.249.146.108","231.87.85.14","224.36.186.241","128.234.9.140","146.132.120.30","246.96.156.67","187.116.135.186","157.253.142.88","195.118.115.46","198.236.183.124","54.206.231.101","73.136.25.178","6.155.117.152","108.191.105.29","9.98.132.177","209.21.192.193","10.152.209.74","182.24.73.138","73.52.39.77","204.140.58.187","99.5.129.74","197.50.64.0","194.230.143.98","165.56.228.176","19.180.131.216","236.56.162.45","98.165.242.49","58.57.214.182","199.44.153.127","111.105.117.199","129.115.120.224","253.54.22.139","223.197.168.34","80.220.253.56","156.35.26.114","210.221.43.250","96.176.1.57","81.75.21.165","229.0.15.21","187.54.211.128","33.246.20.161","181.113.2.68","148.162.254.205","49.8.137.147","97.132.123.254","31.98.93.180","71.4.175.99","99.66.154.217","170.15.142.87","69.230.186.10","212.185.160.40","163.98.29.164","26.163.185.230","242.201.244.19","138.141.205.59","95.96.236.223","228.213.87.198","4.85.29.72","67.138.121.2","244.234.11.239","151.62.43.111","252.229.48.208","31.25.103.204","203.145.188.167","220.196.88.157","124.222.183.107","181.235.123.196","240.158.28.218","140.7.100.191","109.1.43.240","47.3.183.133","13.32.216.202","170.207.227.122","235.54.55.195","200.2.249.143","157.224.125.222","82.164.46.112","108.61.166.156","179.100.42.233","157.110.133.143","248.87.178.43","141.242.198.53","151.246.56.73","196.48.57.122","87.64.157.126","48.57.197.34","164.174.188.108","75.251.35.171","32.135.134.122","55.212.43.35","116.252.140.22","243.197.197.209","230.53.88.234","175.217.130.162","137.92.227.110","228.211.191.109","157.169.141.219","150.236.117.82","124.104.150.103","166.152.226.20"],"job":"Registered Nurse","name":"Gerald Bennett","phone":"987-58-24"}
{"browsers":["Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko","Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.168 Safari/537.36","Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:58.0) Gecko/20100101 Firefox/58.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.146 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;  Trident/5.0)","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1 Safari/605.1.15"],"company":"Aivee","country":"Hungary","email":"iMitchell@Skyndu.edu","hits":["206.4.28.220","250.29.5.171","43.228.61.130","169.188.72.85","254.43.49.221","226.127.144.32","80.247.244.98","198.81.239.89","208.127.1.96","124.230.243.77","157.186.1.138","110.195.68.150","220.230.247.167","217.136.252.139","170.162.115.7","207.247.117.170","9.145.164.196","68.171.231.66","49.64.102.6","229.173.110.153","213.8.44.184","109.194.218.237","17.150.161.38","204.149.181.244","188.200.188.23","77.229.38.131","234.113.58.236","215.34.230.91","76.231.99.105","65.70.126.169","114.2.54.239","188.205.173.19","33.52.69.128","66.127.3.183","190.186.217.24","198.110.242.241","73.118.7.173","208.28.147.31","98.3.73.175","118.187.110.126","62.44.89.176","181.193.253.46","135.35.88.119","147.248.148.46","96.28.185.249","1.120.101.148","83.219.183.214","222.24.187.91","206.157.57.131","94.124.220.162","84.240.80.82","152.88.127.149","43.110.89.61","87.206.154.68","251.193.1.194","213.244.218.54","52.169.136.144","229.240.109.20","131.46.225.52","183.146.178.41","150.244.28.26","17.174.117.131","190.5.225.175","24.189.1.51","30.211.228.178","205.62.142.43","8.249.183.232","240.35.67.184","84.78.217.40","173.169.149.90","32.12.165.219","170.182.213.162","21.178.196.109","231.242.220.187","192.250.242.114","47.221.198.246","85.67.223.152","142.97.128.128","183.146.100.235","59.15.98.85","251.100.175.239","9.209.47.20","238.222.154.147","0.200.186.255","181.105.58.115","168.127.235.87","172.253.152.201","255.141.206.47","29.132.30.197","217.129.183.186","122.36.211.221","50.15.32.230","239.167.56.228","104.29.171.78","237.8.26.50","126.85.64.244","162.134.115.168","159.29.47.223","236.141.163.229","108.38.130.174"],"job":"Marketing Assistant","name":"Anna Mccoy","phone":"679-55-98"}
{"browsers":["Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0","Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/64.0.3282.167 Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.168 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36"],"company":"Photojam","country":"Bouvet Island","email":"BrianSanchez@Meevee.gov","hits":["53.25.54.116","158.164.165.186","58.234.193.203","99.128.52.161","159.197.129.149","206.221.153.33","146.187.181.171","32.171.65.97","1.2.111.241","27.196.77.119","73.224.123.147","26.202.149.17","124.57.168.3","236.192.222.254","89.169.33.195","246.133.236.253","86.49.138.170","165.38.104.245","22.47.226.66","192.52.85.117","208.62.252.54","6.50.165.43","197.13.73.156","44.222.78.78","16.78.155.183","126.16.65.3","197.207.132.149","93.48.244.38","233.252.217.51","199.95.220.68","217.11.129.222","134.142.160.80","204.200.193.129","190.18.230.46","11.11.104.199","183.120.119.35","218.79.61.194","205.224.162.45","241.253.62.216","210.249.220.234","182.231.57.210","117.27.149.143","169.175.48.8","0.246.81.130","69.219.250.101","126.110.73.176","133.160.114.54","62.213.117.85","46.135.63.121","170.162.30.12","251.192.42.31","117.230.202.65","206.6.33.233","248.0.16.75","140.215.208.241","195.159.175.247","104.191.47.21","207.202.124.192","20.144.80.141","92.105.150.67","206.37.179.73","230.96.60.3","34.166.211.153","129.21.159.155","252.40.224.242","133.122.222.214","204.185.154.75","46.191.108.224","137.158.130.195","11.95.125.111","207.154.91.137","235.102.233.181","245.179.208.245","222.101.3.30","143.116.30.80","107.255.112.27","137.21.47.69","29.83.92.231","186.226.178.18","58.101.74.86","147.89.194.132","135.232.105.127","199.205.173.205","97.24.99.166","51.1.157.106","127.122.21.106","23.52.2.199","223.218.115.46","243.189.23.141","139.119.144.162","108.87.146.118","77.167.211.158","56.94.49.254","237.60.247.164","81.230.151.151","152.78.218.109","253.1.78.183","140.86.65.205","141.58.198.53","252.5.174.10"],"job":"Tax Accountant","name":"Joe Jones","phone":"591-96-40"}
{"browsers":["Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;  Trident/5.0)","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.119 Safari/537.36","Mozilla/5.0 (iPad; CPU OS 11_2_5 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0 Mobile/15D60 Safari/604.1","Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (iPad; CPU OS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0 Mobile/15D100 Safari/604.1"],"company":"Rhybox","country":"Liechtenstein","email":"quia_accusamus@Thoughtmix.net","hits":["243.218.39.184","154.11.72.160","224.41.119.235","98.201.218.188","50.245.161.227","145.151.52.158","50.73.77.27","142.242.249.98","247.116.234.120","154.19.221.96","190.137.7.16","53.196.215.188","112.116.102.62","57.203.128.52","72.208.65.84","228.33.160.169","58.7.146.160","216.71.54.215","156.223.101.161","208.60.184.196","162.235.142.76","137.203.97.141","235.238.221.100","107.227.30.5","110.154.40.131","236.32.140.130","33.10.53.72","24.15.28.177","53.46.32.185","86.51.133.125","160.64.56.108","7.173.234.208","148.53.102.210","234.150.243.123","142.169.119.233","8.109.221.221","2.233.207.170","249.171.37.74","94.156.36.229","234.192.18.74","11.177.216.81","0.115.90.197","73.47.4.229","77.206.69.174","146.253.33.208","178.254.137.104","35.89.106.225","130.251.177.120","15.24.61.36","83.49.114.194","16.179.111.78","86.152.78.153","122.218.48.197","4.172.207.203","192.42.44.91","168.92.155.151","65.156.106.9","159.241.21.75","149.195.100.141","19.191.51.34","64.2.61.111","72.41.228.212","251.215.101.119","138.112.240.163","241.168.59.200","216.36.121.86","242.156.180.120","141.152.112.163","107.82.242.158","143.63.184.164","113.106.43.127","141.208.47.21","232.67.44.51","181.28.144.98","36.157.244.208","156.46.159.21","176.60.219.113","221.202.241.212","6.206.61.238","202.101.64.56","84.82.24.51","109.10.198.242","222.154.14.46","7.129.85.130","26.76.65.66","124.100.202.70","192.177.7.156","234.148.39.93","68.166.186.215","214.78.154.199","63.77.234.143","61.12.20.133","212.201.55.127","58.45.4.118","10.191.197.102","253.129.34.174","149.173.173.224","210.215.235.5","178.50.4.159","245.120.232.36"],"job":"Research Associate","name":"Frances Long","phone":"999-42-17"}
{"browsers":["Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.1 Safari/605.1.15","Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0","Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko","Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0"],"company":"Photobean","country":"American Samoa","email":"nulla@Meevee.name","hits":["236.224.110.201","18.131.2.166","42.109.37.106","155.178.221.30","67.155.88.130","126.232.227.54","118.18.116.111","253.198.21.18","134.185.60.170","96.207.79.243","168.4.78.95","19.116.153.133","22.179.62.140","29.95.234.171","241.202.195.214","211.136.107.40","184.247.108.125","32.58.139.170","47.225.146.255","24.84.73.45","158.92.160.88","191.226.44.45","186.110.20.253","153.108.178.153","97.193.19.107","20.26.207.111","31.80.65.204","72.250.191.247","7.168.141.13","174.185.173.145","165.8.109.252","190.67.169.172","101.216.139.189","198.159.246.103","179.139.208.94","76.180.115.48","66.207.214.186","234.251.235.115","170.234.240.58","219.4.173.20","16.11.151.157","99.247.196.41","251.225.98.33","195.232.106.186","123.123.234.78","253.144.147.88","24.198.237.152","239.87.75.140","125.108.189.42","49.26.140.36","15.198.13.183","47.137.6.9","47.202.81.134","67.36.27.187","112.15.235.188","140.37.207.149","246.68.231.37","140.24.22.167","155.127.180.40","129.253.24.118","208.72.16.227","154.215.171.252","138.121.61.192","193.50.87.184","185.11.158.115","138.54.23.67","74.60.97.213","61.2.46.160","236.94.104.57","20.230.80.157","26.157.138.132","178.50.167.189","28.236.165.2","115.104.249.47","226.223.1.124","66.195.227.136","253.151.244.233","195.47.102.186","114.206.8.37","2.134.254.77","86.7.171.170","223.171.65.77","209.40.167.219","181.23.11.150","142.195.16.119","70.72.112.19","151.238.82.116","207.158.210.247","71.190.80.208","183.239.29.171","113.38.146.117","105.93.16.52","157.230.124.237","17.98.123.100","246.155.118.156","78.58.254.57","114.111.130.207","174.204.248.240","223.227.29.59","145.100.124.31"],"job":"Teacher","name":"Jonathan Moore","phone":"9-366-722-62-75"}
{"browsers":["Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.146 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 OPR/51.0.2830.34","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0"],"company":"Jazzy","country":"Western Sahara","email":"HeatherMurray@Flashpoint.mil","hits":["104.144.32.65","32.252.232.167","233.165.94.121","187.127.57.243","172.2.137.209","247.250.156.181","175.97.15.229","113.186.158.16","93.183.166.115","165.139.22.27","130.124.238.54","112.82.139.11","107.172.130.13","11.223.54.112","213.250.215.30","47.196.147.110","132.187.31.2","15.55.177.201","132.38.216.30","108.176.20.90","226.151.125.81","97.54.9.141","163.45.26.99","98.44.195.204","243.133.151.94","45.135.41.163","96.14.230.195","28.232.210.170","29.89.20.63","134.72.52.33","37.113.214.14","178.176.40.183","14.159.81.47","221.106.181.122","243.133.45.90","8.255.249.75","95.99.192.204","17.39.23.193","9.155.117.66","158.189.23.5","199.50.98.30","93.115.20.17","74.224.211.68","54.217.29.8","181.180.176.39","177.44.195.88","27.116.107.229","180.255.27.146","180.248.211.189","80.98.193.246","229.4.7.113","153.224.209.61","64.141.142.54","129.195.151.233","120.68.232.94","168.47.222.176","65.228.147.203","59.93.88.230","57.20.247.10","4.226.38.242","75.215.221.181","251.121.9.38","247.112.171.68","187.79.89.226","44.225.172.13","101.135.2.254","117.209.241.108","231.226.208.237","27.38.170.155","74.100.56.43","213.16.173.91","214.239.87.117","20.176.19.24","153.253.109.212","19.208.133.150","93.31.166.17","73.66.82.207","115.107.222.5","170.7.128.237","68.220.36.55","95.63.47.235","248.52.173.120","163.188.119.23","145.189.46.109","180.146.129.101","87.122.12.75","94.155.225.74","12.178.21.253","1.70.185.93","47.193.224.18","250.116.23.122","209.142.84.35","33.24.90.128","233.237.59.116","185.241.24.31","205.103.195.243","14.116.70.197","7.208.84.217","59.156.130.62","195.242.49.74"],"job":"Structural Analysis Engineer","name":"Jimmy Jackson","phone":"151-53-65"}
{"browsers":["Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36","Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.119 Safari/537.36","Mozilla/5.0 (iPad; CPU OS 11_2_6 like Mac OS X) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0 Mobile/15D100 Safari/604.1","Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0","Mozilla/5.0 (Windows NT 10.0; WOW64; rv:58.0) Gecko/20100101 Firefox/58.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36"],"company":"Wikizz","country":"Togo","email":"omnis@Quinu.org","hits":["133.11.67.17","37.91.222.57","219.31.238.56","109.79.145.62","140.106.77.10","76.131.22.14","30.18.247.103","4.10.18.160","92.64.105.187","214.247.213.48","219.73.65.26","29.95.176.218","115.99.225.78","255.120.8.56","164.163.90.182","69.118.178.241","162.61.8.156","96.222.90.239","184.146.108.212","215.0.10.61","55.144.137.202","173.18.140.22","169.137.243.177","216.109.36.69","62.123.13.31","46.58.57.98","20.79.32.110","128.224.4.32","237.206.31.38","219.159.160.67","202.165.46.168","101.215.119.219","62.218.19.198","220.135.208.176","29.92.92.205","204.171.76.217","150.229.199.51","35.146.156.10","204.227.142.223","154.79.145.210","206.24.133.205","160.85.121.75","3.141.129.15","159.243.34.211","255.144.232.245","137.143.151.3","211.73.66.34","179.130.5.0","217.173.207.30","182.221.252.114","247.148.168.222","169.81.152.250","156.62.155.115","46.65.37.164","152.155.85.131","117.182.26.127","56.202.158.221","58.94.206.240","232.49.190.10","246.111.150.194","101.10.61.93","86.15.240.33","226.28.115.87","60.123.129.51","140.217.6.192","144.81.172.143","2.122.55.48","130.102.146.132","86.9.91.174","76.134.220.151","199.3.28.118","32.25.11.188","153.188.6.73","35.227.76.178","114.150.196.219","86.72.160.60","93.21.145.6","58.148.22.217","210.35.14.255","15.223.33.70","125.195.107.102","241.18.29.116","113.98.245.210","128.223.23.73","81.241.111.164","237.16.252.234","156.194.180.107","63.72.25.31","10.174.148.88","54.188.232.4","165.180.4.97","226.43.88.220","32.139.90.94","186.54.87.116","134.206.250.215","150.75.238.125","122.180.206.33","214.167.25.99","58.254.115.168","125.174.231.110"],"job":"Assistant Manager","name":"Nicholas Hicks","phone":"0-353-912-32-06"}
{"browsers":["Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Windows NT 5.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.162 Safari/537.36","Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36","Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;  Trident/5.0)","Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36","Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36"],"company":"Brainlounge","country":"Luxembourg","email":"aspernatur_dicta_distinctio@Kwideo.org","hits":["126.232.216.31","61.177.192.227","78.109.173.157","117.80.55.98","32.54.155.178","109.247.18.231","94.252.3.42","182.212.238.53","134.76.6.72","47.163.169.18","176.137.40.188","67.224.208.226","118.80.204.120","108.166.195.215","255.203.230.12","113.64.218.163","51.70.48.43","137.190.250.47","9.122.157.177","83.37.77.4","201.199.136.97","40.72.238.26","211.35.20.232","247.62.135.42","38.74.15.67","33.218.51.82","30.90.122.100","3.245.80.36","231.3.136.82","236.158.45.49","246.55.240.19","183.137.156.158","107.81.119.9","167.47.119.193","68.163.152.107","218.138.254.7","13.125.166.223","210.116.138.85","84.165.21.3","75.56.70.111","97.69.133.147","179.156.105.252","165.119.252.147","4.186.78.8","140.38.236.86","187.53.98.172","121.203.214.3","9.59.234.152","192.38.223.168","182.132.191.212","242.167.31.69","128.64.88.27","93.138.154.8","173.18.44.153","56.2.136.179","81.207.36.133","240.75.223.201","156.223.70.19","223.255.174.237","248.110.86.181","151.106.248.74","58.41.11.35","195.90.64.172","44.233.242.199","111.244.28.47","98.184.92.222","26.12.225.133","138.92.96.31","131.92.205.167","193.254.123.212","205.108.246.172","202.100.84.12","14.150.78.5","12.149.178.100","141.199.29.189","223.125.65.240","174.185.142.217","175.164.230.116","121.154.45.218","67.23.191.251","130.73.56.27","91.154.123.101","46.55.250.254","229.80.76.158","213.6.77.162","155.14.65.73","93.147.193.97","255.148.141.101","109.82.183.180","174.114.56.243","188.210.48.214","197.169.35.180","107.9.254.208","7.231.169.32","17.193.0.62","175.182.16.237","234.153.205.150","100.136.175.186","106.30.81.60","142.151.204.195"],"job":"Executive Secretary","name":"Jessica Jordan","phone":"9-452-701-15-65"}
`,
		Result: `Total: 2
[1] Gerald Bennett <saepe_voluptatem [at] Zoomdog.com>
[8] Jessica Jordan <aspernatur_dicta_distinctio [at] Kwideo.org>
`,
	},
	TestCase{ // 0/3
		In: `{"browsers":["Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.146 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_3) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/604.5.6 (KHTML, like Gecko) Version/11.0.3 Safari/604.5.6","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"],"company":"Oyoloo","country":"Nigeria","email":"AnnCarr@Dabfeed.biz","hits":["135.75.244.74","111.71.154.219","60.174.198.36","36.114.142.90","208.161.85.252","232.136.243.74","236.72.68.249","220.210.100.29","227.135.48.63","239.216.83.199","133.39.183.77","148.80.238.65","164.230.46.192","21.6.52.15","78.137.83.233","216.45.75.169","215.27.12.157","87.252.106.176","68.101.87.74","13.160.51.131","139.244.170.177","133.89.81.54","148.90.74.248","27.110.99.123","20.251.211.252","1.210.77.130","154.63.246.85","217.105.216.6","37.32.207.160","1.203.110.113","229.164.144.49","214.170.120.76","76.58.167.218","129.44.61.71","247.144.203.126","93.110.118.155","33.19.33.142","72.239.88.109","76.36.89.59","104.171.176.54","115.224.165.132","33.145.162.249","79.39.98.17","18.205.193.90","63.199.44.170","120.192.12.243","240.51.71.166","233.246.200.118","199.142.45.230","167.118.139.193","231.114.222.127","143.152.106.115","253.31.48.93","63.255.251.16","179.232.44.78","3.69.255.15","36.125.4.193","1.200.99.147","21.157.167.133","232.216.251.19","33.14.170.28","42.0.167.153","107.19.35.204","47.137.125.123","61.148.223.136","106.120.195.212","226.126.124.49","20.150.249.74","225.6.178.216","195.233.72.72","104.97.84.189","52.116.163.197","57.197.52.91","41.99.220.252","227.176.147.165","171.45.147.55","8.220.190.70","222.227.8.127","135.58.52.153","152.155.182.217","98.243.131.6","4.16.4.170","202.127.144.23","247.110.248.68","138.45.43.68","171.81.57.112","112.8.84.21","113.21.92.22","163.134.179.114","6.106.99.21","140.167.154.36","2.131.29.7","7.1.135.146","89.233.114.167","82.243.101.174","213.74.24.237","206.204.3.65","204.115.179.161","89.51.174.178","69.189.2.110"],"job":"Junior Executive","name":"Mildred Nelson","phone":"5-035-702-50-04"}
{"browsers":["Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/604.4.7 (KHTML, like Gecko) Version/11.0.2 Safari/604.4.7","Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; Touch; rv:11.0) like Gecko","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36"],"company":"Fanoodle","country":"Sierra Leone","email":"sint_sed_ipsum@Skibox.org","hits":["125.232.93.173","50.124.194.187","25.172.126.173","203.252.48.144","166.215.73.74","86.109.189.36","75.226.245.26","56.236.38.223","63.128.234.96","171.128.93.22","86.42.165.9","208.166.136.233","212.34.16.63","148.84.206.221","128.154.240.97","4.115.141.36","234.99.166.94","164.210.58.240","232.141.103.244","174.164.27.38","143.126.150.186","138.245.206.221","245.80.226.43","199.167.121.246","122.239.128.77","119.236.20.224","197.157.14.253","111.51.198.109","189.225.11.162","254.54.121.5","163.48.74.21","147.128.41.237","243.179.159.250","163.33.223.117","207.128.193.104","64.195.29.17","21.149.253.6","92.46.250.162","42.223.98.10","42.249.113.186","111.87.125.173","37.228.3.199","219.9.34.168","147.65.109.87","36.206.232.242","113.60.183.128","125.66.119.92","45.114.79.207","45.248.137.223","248.139.73.236","114.229.73.26","80.122.93.24","14.72.193.230","135.217.98.70","252.102.203.197","172.186.232.17","251.48.51.74","64.249.157.117","192.224.221.129","188.162.71.41","141.88.3.93","173.48.250.193","41.51.180.93","16.1.71.180","48.239.19.233","198.173.162.134","204.214.238.107","145.198.143.102","167.146.170.143","97.172.71.116","187.129.216.1","245.171.112.163","234.81.212.20","198.124.135.66","114.16.133.12","121.63.149.84","208.31.152.120","32.243.184.170","145.212.84.217","22.172.107.65","140.228.155.120","221.139.76.188","159.154.30.91","159.164.209.85","128.18.190.182","126.122.129.132","149.111.62.107","92.241.29.134","204.197.239.175","154.17.254.37","150.10.115.101","78.65.114.198","159.142.125.200","99.178.251.55","61.222.178.125","5.64.250.114","9.233.156.114","149.253.5.154","24.168.2.209","242.134.176.239"],"job":"Accountant IV","name":"Sandra Pierce","phone":"3-607-504-57-99"}
{"browsers":["Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36","Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.167 Safari/537.36","Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;  Trident/5.0)","Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:58.0) Gecko/20100101 Firefox/58.0","Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.119 Safari/537.36","Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:57.0) Gecko/20100101 Firefox/57.0","Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0","Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36","Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:52.0) Gecko/20100101 Firefox/52.0"],"company":"Npath","country":"Mongolia","email":"fWilliams@Jaxbean.info","hits":["28.20.207.37","194.21.149.23","55.202.224.161","69.200.232.42","176.227.12.57","237.142.103.64","31.135.181.82","135.180.27.53","216.207.149.24","111.29.119.58","92.239.126.213","86.119.207.9","3.136.75.99","61.147.118.179","121.168.123.250","190.97.74.218","171.137.82.243","55.200.166.42","50.14.146.96","46.49.66.228","225.111.45.206","134.68.148.40","235.228.9.223","0.127.88.191","97.41.63.231","143.62.13.42","1.213.23.63","51.220.161.9","220.119.235.228","183.246.91.46","216.27.198.9","79.19.33.97","83.238.42.94","0.30.190.80","177.159.76.195","222.237.174.23","40.248.95.32","240.104.78.209","137.111.34.44","164.177.75.68","35.235.22.79","185.6.19.184","248.206.153.157","83.15.241.17","233.70.150.162","58.205.85.70","84.109.214.184","229.42.63.177","100.95.129.226","241.246.160.246","121.65.198.2","217.188.182.157","229.237.150.227","43.229.126.142","232.34.85.103","173.108.156.240","15.100.208.224","15.144.166.203","29.111.42.220","84.81.97.155","139.174.251.68","188.80.18.170","254.37.233.79","5.6.154.206","6.187.243.171","37.6.158.89","93.79.217.53","235.59.103.218","19.19.185.220","149.150.38.207","47.69.225.186","182.232.153.225","9.250.153.71","212.248.169.131","171.212.208.43","70.25.140.238","192.176.166.106","216.210.92.69","97.50.124.31","224.28.140.144","218.53.223.184","226.247.16.9","243.221.180.63","207.214.68.32","111.210.30.62","242.144.123.145","111.242.109.185","200.50.18.26","132.28.225.87","139.61.165.212","146.168.29.207","87.126.26.131","26.190.0.202","175.187.182.233","186.113.82.185","80.104.62.69","151.10.130.225","162.69.222.186","88.101.31.20","232.124.202.230"],"job":"Compensation Analyst","name":"Arthur Carter","phone":"3-366-955-37-00"}
`,
		Result: `Total: 0
`,
	},
}

func TestForOk(t *testing.T) {
	for idx, item := range cases {
		in := bytes.NewBufferString(item.In)
		out := bytes.NewBuffer(nil)
		Fast(in, out, networks)
		result := out.String()
		if result != item.Result {
			t.Errorf("Test %d failed, result not match:\n\tGot: %s\n\tWant: %s", idx, result, item.Result)
			t.Errorf("Test %d failed, result not match:\n\tGot: %v\n\tWant: %v", idx, []byte(item.Result), []byte(item.Result))
		}
	}
}

func TestEquals(t *testing.T) {
	out := bytes.NewBuffer(nil)
	Fast(bytes.NewReader(data), out, networks)
	result1 := out.String()

	out = bytes.NewBuffer(nil)
	Fast(bytes.NewReader(data), out, networks)
	result2 := out.String()

	if result1 != result2 {
		t.Errorf("Results not equal")
	}
}

func TestBig128(t *testing.T) {
	f, err := os.Open("./data_128.json")
	if err != nil {
		panic(err)
	}
	dataIn, _ := ioutil.ReadAll(f)
	f.Close()

	f, err = os.Open("./data_128_result.txt")
	if err != nil {
		panic(err)
	}
	dataResult, _ := ioutil.ReadAll(f)
	f.Close()

	// out, _ := os.Create("./data_128_result.txt")
	out := bytes.NewBuffer(nil)
	Fast(bytes.NewReader(dataIn), out, networks)
	result1 := out.String()
	// result1 := ""

	if result1 != string(dataResult) {
		t.Errorf("Results not equal")
	}
}

func BenchmarkFast(b *testing.B) {
	b.ResetTimer()
	for i := 0; i < b.N; i++ {
		Fast(bytes.NewReader(data), ioutil.Discard, networks)
	}
}
